<template>
  <div id="earthquake-chart">
    <plotly :data="data" :layout="layout" :display-mode-bar="false"></plotly>
    <button @click="updateChart">update</button>
  </div>
</template>

<script>
import { Plotly } from "vue-plotly";
import axios from "axios";

export default {
  name: "EarthquakeChart",
  data() {
    const originalMarkerSize = [
      2.2999999999999998,
      0,
      0.80000000000000004,
      1.7,
      0.5,
      0.5,
      2.6000000000000001,
      0.69999999999999996,
      2.2999999999999998,
      0.29999999999999999,
      3.6000000000000001,
      9,
      0,
      0,
      4.7000000000000002,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      6.7999999999999998,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      6.0999999999999996,
      5.7000000000000002,
      4.0999999999999996,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      2.7000000000000002,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      6,
      3.5,
      0,
      0,
      0,
      0,
      0,
      0,
      2.7000000000000002,
      0,
      0,
      3.2999999999999998,
      5.2000000000000002,
      0,
      4.7000000000000002,
      2.7999999999999998,
      5.7000000000000002,
      3.3999999999999999,
      0,
      0,
      0,
      0,
      6.5999999999999996,
      0,
      0,
      0,
      2.8999999999999999,
      2.6000000000000001,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      2.5,
      3.2000000000000002,
      0,
      0,
      0,
      3.2000000000000002,
      0,
      3.2999999999999998,
      0,
      0,
      0
    ];
    const markerSize = originalMarkerSize.map(
      el => ((el + 1.0) * (el + 1.0)) / 10 + 1.0
    );
    const textColor = "#eaeaea";
    const markerColor = "#ff5959";
    return {
      data: [
        {
          x: [
            142.64123333333299,
            129.45849999999999,
            137.436933333333,
            142.96746666666701,
            130.75360000000001,
            137.46926666666701,
            142.9074,
            135.25989999999999,
            143.45769999999999,
            138.021166666667,
            143.12266666666699,
            142.85659999999999,
            137.40379999999999,
            137.62356666666699,
            139.176266666667,
            139.00970000000001,
            137.75129999999999,
            137.60419999999999,
            137.622966666667,
            137.590133333333,
            134.97256666666701,
            137.53773333333299,
            142.66976666666699,
            137.618766666667,
            139.02046666666701,
            142.23583333333301,
            139.017666666667,
            139.107,
            137.60990000000001,
            140.85669999999999,
            137.80860000000001,
            137.93963333333301,
            134.468066666667,
            139.02006666666699,
            134.45169999999999,
            137.892433333333,
            134.45079999999999,
            137.1585,
            137.54183333333299,
            139.0087,
            134.776166666667,
            131.42596666666699,
            139.017766666667,
            131.43473333333301,
            134.73933333333301,
            131.24293333333301,
            131.40899999999999,
            137.60329999999999,
            131.4024,
            136.668566666667,
            135.00149999999999,
            139.01886666666701,
            137.62596666666701,
            131.39093333333301,
            137.15950000000001,
            130.57276666666701,
            139.58793333333301,
            139.02076666666699,
            139.02076666666699,
            139.25540000000001,
            138.97616666666701,
            131.41896666666699,
            138.49203333333301,
            139.01986666666701,
            137.53673333333299,
            137.64093333333301,
            137.31716666666699,
            131.436733333333,
            131.369766666667,
            139.022866666667,
            131.192933333333,
            137.05889999999999,
            130.623166666667,
            141.3519,
            140.57556666666699,
            137.687633333333,
            137.271266666667,
            134.7552,
            139.01996666666699,
            139.01926666666699,
            137.09063333333299,
            131.45179999999999,
            138.085833333333,
            131.33433333333301,
            137.58693333333301,
            134.525366666667,
            139.020266666667,
            137.4588,
            134.97366666666699,
            134.52496666666701,
            133.72606666666701,
            129.12256666666701,
            137.53553333333301,
            139.3082,
            141.770366666667,
            139.10740000000001,
            131.44323333333301,
            135.27266666666699,
            131.45050000000001,
            139.2552,
            131.23413333333301,
            134.15209999999999,
            137.68493333333299,
            137.643233333333,
            131.176166666667,
            137.607,
            141.119766666667,
            134.972266666667,
            137.57566666666699,
            130.22266666666701,
            142.34143333333299,
            137.57306666666699,
            139.17326666666699,
            132.435133333333,
            137.56856666666701,
            133.80240000000001,
            141.93363333333301,
            131.18643333333301,
            123.988333333333,
            134.7569,
            139.22086666666701,
            137.56936666666701,
            137.636433333333,
            139.02316666666701,
            139.01996666666699,
            131.389733333333,
            137.58393333333299,
            130.55179999999999,
            139.27486666666701,
            137.570866666667,
            139.134733333333,
            130.07116666666701,
            137.57376666666701,
            139.01976666666701,
            137.62006666666699,
            137.60740000000001,
            139.19143333333301,
            130.841833333333,
            137.61896666666701,
            131.417466666667
          ],
          y: [
            38.433333333333302,
            29.074066666666699,
            36.152200000000001,
            38.607900000000001,
            33.3881333333333,
            36.1599,
            38.269566666666698,
            34.0170666666667,
            38.102699999999999,
            36.174766666666699,
            38.604799999999997,
            38.1021,
            34.904800000000002,
            36.467066666666703,
            34.383433333333301,
            35.2074,
            36.705599999999997,
            36.389533333333297,
            36.455100000000002,
            36.266766666666697,
            35.7406333333333,
            36.238533333333301,
            43.374866666666698,
            36.4874333333333,
            35.218766666666703,
            37.306399999999996,
            35.255200000000002,
            34.250700000000002,
            36.475166666666702,
            40.471366666666697,
            34.809800000000003,
            34.817066666666697,
            33.871566666666702,
            35.225566666666701,
            35.100200000000001,
            37.935233333333301,
            35.091133333333303,
            34.802100000000003,
            36.140233333333299,
            35.217766666666698,
            33.104399999999998,
            33.301600000000001,
            35.221366666666697,
            33.2922333333333,
            35.687633333333302,
            33.100700000000003,
            33.275366666666699,
            36.250999999999998,
            33.307499999999997,
            37.207900000000002,
            33.202800000000003,
            35.200800000000001,
            36.468066666666701,
            33.269466666666702,
            35.024366666666701,
            31.208300000000001,
            37.593233333333302,
            35.225066666666699,
            35.222466666666698,
            34.770866666666699,
            34.789733333333302,
            33.289433333333299,
            38.1223666666667,
            35.209099999999999,
            36.235833333333296,
            36.425566666666697,
            34.8896333333333,
            33.288733333333298,
            34.808999999999997,
            35.233533333333298,
            33.109299999999998,
            37.207599999999999,
            31.2514,
            37.504800000000003,
            36.707999999999998,
            36.552199999999999,
            35.971866666666699,
            33.805700000000002,
            35.2229666666667,
            35.236933333333297,
            34.905900000000003,
            33.289933333333302,
            34.939333333333302,
            33.2892333333333,
            36.251800000000003,
            34.0202666666667,
            35.222066666666699,
            34.921566666666699,
            35.740333333333297,
            33.736733333333298,
            35.373466666666701,
            29.1253666666667,
            36.150799999999997,
            34.7042,
            36.488833333333297,
            34.317066666666697,
            33.284633333333304,
            34.002699999999997,
            33.283433333333299,
            34.721066666666701,
            33.0718666666667,
            35.453800000000001,
            36.107900000000001,
            36.851300000000002,
            33.120166666666698,
            36.468666666666699,
            37.401200000000003,
            35.739133333333299,
            36.243033333333301,
            33.707799999999999,
            39.204999999999998,
            36.253599999999999,
            34.242433333333302,
            32.784633333333304,
            36.258499999999998,
            34.219366666666701,
            37.686733333333301,
            33.108899999999998,
            24.806699999999999,
            33.818766666666697,
            34.290633333333297,
            36.2577,
            36.492733333333298,
            35.233433333333302,
            35.233833333333301,
            33.270566666666703,
            36.241133333333302,
            31.2087,
            34.757100000000001,
            36.256500000000003,
            34.309899999999999,
            32.768166666666701,
            36.252000000000002,
            35.223366666666699,
            36.503700000000002,
            36.491533333333301,
            34.276566666666703,
            31.8596,
            36.4872333333333,
            33.302399999999999
          ],
          z: [
            24.75,
            17.77,
            5.71,
            21.920000000000002,
            6.8899999999999997,
            5.2400000000000002,
            13.68,
            7.2800000000000002,
            16,
            4.7300000000000004,
            8.9000000000000004,
            23.739999999999998,
            39.659999999999997,
            1.6799999999999999,
            10.130000000000001,
            5,
            0.23000000000000001,
            6.9800000000000004,
            1.6399999999999999,
            3.3500000000000001,
            14.41,
            4.4900000000000002,
            0,
            1.8100000000000001,
            4.1200000000000001,
            33,
            4.1799999999999997,
            9.1899999999999995,
            5,
            4.04,
            33.590000000000003,
            33.609999999999999,
            31.809999999999999,
            3.6099999999999999,
            13.42,
            13.09,
            14.23,
            38.890000000000001,
            2.3399999999999999,
            5.7699999999999996,
            26.510000000000002,
            6.4500000000000002,
            3.6400000000000001,
            5.7000000000000002,
            14.539999999999999,
            5.5700000000000003,
            7.6299999999999999,
            4.5199999999999996,
            5.54,
            8.5500000000000007,
            35.109999999999999,
            3.5099999999999998,
            6.4100000000000001,
            7.1799999999999997,
            41.810000000000002,
            5.5999999999999996,
            13.82,
            4.4900000000000002,
            3.25,
            0.29999999999999999,
            3.0099999999999998,
            5.2699999999999996,
            15.82,
            3.3599999999999999,
            4.5199999999999996,
            2.7599999999999998,
            36.469999999999999,
            5.1900000000000004,
            14.029999999999999,
            1.3999999999999999,
            7.29,
            16.98,
            7.54,
            34.119999999999997,
            9.5299999999999994,
            0,
            8.6600000000000001,
            34.770000000000003,
            4.1500000000000004,
            4.25,
            35.869999999999997,
            4.54,
            33.5,
            6.46,
            2.7000000000000002,
            36.530000000000001,
            3.02,
            37.82,
            14.26,
            39.159999999999997,
            14.07,
            8.1300000000000008,
            4,
            6.8899999999999997,
            55,
            11.18,
            6.7199999999999998,
            10.82,
            6.3499999999999996,
            0,
            3.6400000000000001,
            12.710000000000001,
            5.8799999999999999,
            0.62,
            4.5899999999999999,
            0.23000000000000001,
            22.129999999999999,
            13.800000000000001,
            2.29,
            6.0899999999999999,
            31.940000000000001,
            2.7599999999999998,
            11.550000000000001,
            34.990000000000002,
            2.4199999999999999,
            18.219999999999999,
            35.200000000000003,
            5.4800000000000004,
            15.039999999999999,
            34.340000000000003,
            0,
            2.21,
            6.8499999999999996,
            2.0899999999999999,
            4.1600000000000001,
            8.6199999999999992,
            3.4199999999999999,
            6.4400000000000004,
            0,
            2.2200000000000002,
            10.35,
            16.940000000000001,
            2.9100000000000001,
            2.7999999999999998,
            2.3500000000000001,
            0.16,
            9.7699999999999996,
            6.5599999999999996,
            1.9099999999999999,
            6.2800000000000002
          ],
          mode: "markers",
          type: "scatter3d",
          marker: {
            color: markerColor,
            line: {
              width: 0
            },
            size: markerSize
          }
        }
      ],
      layout: {
        autosize: true,
        font: {
          color: textColor
        },
        width: 1024,
        height: 700,
        paper_bgcolor: "#282520",
        scene: {
          aspectratio: {
            x: this.xMax - this.xMin,
            y: this.yMax - this.yMin,
            z: (this.zMax - this.zMin) / 100
          },
          camera: {
            center: {
              x: 0,
              y: 0,
              z: 0
            },
            eye: {
              x: 13.12,
              y: -32.88,
              z: 18.42
            },
            up: {
              x: 0,
              y: 0,
              z: 1
            }
          },
          xaxis: {
            color: textColor,
            type: "linear",
            zeroline: false
          },
          yaxis: {
            color: textColor,
            type: "linear",
            zeroline: false
          },
          zaxis: {
            autorange: "reversed",
            color: textColor,
            type: "linear",
            zeroline: false
          }
        },
        title: "Earthquake Source Distribution"
      }
    };
  },
  methods: {
    updateChart() {
      axios
        .get(
          "https://slash-mochi.net/earthquake-data-manager/get-earthquake-data.php",
          {
            params: {
              min_date: "2011-03-12 14:00:00",
              max_date: "2011-03-12 15:00:00"
            }
          }
        )
        .then(res => {
          this.data[0].x = res.data.longitude;
          this.data[0].y = res.data.latitude;
          this.data[0].z = res.data.depth;
          this.data[0].marker.size = res.data.magnitude.map(
            el => ((el + 1.0) * (el + 1.0)) / 10 + 1.0
          );
        });
    }
  },
  props: {
    markerColor: {
      default: "#169632",
      required: false,
      type: String
    },
    chartData: {
      default: () => [],
      required: true,
      type: Array
    },
    xMin: {
      default: 0.0,
      required: false,
      type: Number
    },
    xMax: {
      default: 1.0,
      required: false,
      type: Number
    },
    yMin: {
      default: 0.0,
      required: false,
      type: Number
    },
    yMax: {
      default: 1.0,
      required: false,
      type: Number
    },
    zMin: {
      default: 0.0,
      required: false,
      type: Number
    },
    zMax: {
      default: 1.0,
      required: false,
      type: Number
    }
  },
  components: {
    Plotly
  }
};
</script>

<style lang="scss" scoped></style>
